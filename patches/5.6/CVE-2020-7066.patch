From a33d05b1474caee449b88f53d61bee720c57caf7 Mon Sep 17 00:00:00 2001
From: Stanislav Malyshev <stas@php.net>
Date: Sun, 15 Mar 2020 17:30:44 -0700
Subject: [PATCH] Fix bug #79329 - get_headers should not accept \0

---
 ext/standard/url.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: php5-5.6.40+dfsg/ext/standard/url.c
===================================================================
--- php5-5.6.40+dfsg.orig/ext/standard/url.c	2020-04-22 16:49:11.327988020 +0200
+++ php5-5.6.40+dfsg/ext/standard/url.c	2020-04-22 16:49:26.876641837 +0200
@@ -675,7 +675,7 @@
 	HashTable *hashT;
 	long format = 0;
 
-	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s|l", &url, &url_len, &format) == FAILURE) {
+	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "p|l", &url, &url_len, &format) == FAILURE) {
 		return;
 	}
 	context = FG(default_context) ? FG(default_context) : (FG(default_context) = php_stream_context_alloc(TSRMLS_C));
